import{r as p,w as P,j as u,x as d,k as e,D as w,t as a,E as v,G as b,l as f,v as n,F as N,h as $,H as V,I as _}from"./auth-p59NCVpB.js";import{_ as h,d as k}from"./index-BaOz1LJw.js";import C from"./ChangePasswordModal-DzrDawE2.js";const S={class:"modal d-block",tabindex:"-1"},B={class:"modal-dialog modal-dialog-centered modal-md"},M={class:"modal-content rounded-4 shadow-lg overflow-hidden"},j={class:"modal-header border-0 bg-gradient-header text-white py-3"},E={class:"modal-body p-4"},z={class:"row g-3"},A={class:"col-12"},U={class:"input-group"},q={class:"col-12"},D={class:"input-group"},I={class:"col-md-6"},T={class:"input-group"},F={class:"col-md-6"},G={class:"input-group"},H={class:"modal-footer border-0 px-4 pb-4 d-flex justify-content-end gap-2"},O=["disabled"],R=["disabled"],J={key:0,class:"spinner-border spinner-border-sm"},K={__name:"ProfileEditModal",props:{initialProfile:{type:Object,required:!0}},emits:["close","saved"],setup(y,{emit:g}){const t=k(),c=y,m=g,l=p({...c.initialProfile}),r=p(!1);P(()=>c.initialProfile,o=>{l.value={...o}},{immediate:!0});async function x(){r.value=!0;try{const o=await $.patch("/profile",l.value);t.show("Profil gespeichert","success"),m("saved",o.data)}catch(o){const s=o.response?.data?.error||"Speichern fehlgeschlagen";t.show(s,"danger")}finally{r.value=!1}}return(o,s)=>(d(),u(N,null,[e("div",{class:"modal-backdrop",onClick:s[0]||(s[0]=w(i=>o.$emit("close"),["self"]))}),e("div",S,[e("div",B,[e("div",M,[e("form",{onSubmit:w(x,["prevent"])},[e("div",j,[s[7]||(s[7]=e("h5",{class:"modal-title d-flex align-items-center gap-2"},[e("i",{class:"bi bi-person-circle"}),a(" Profil bearbeiten ")],-1)),e("button",{type:"button",class:"btn-close btn-close-white",onClick:s[1]||(s[1]=i=>o.$emit("close")),"aria-label":"Schließen"})]),e("div",E,[e("div",z,[e("div",A,[s[9]||(s[9]=e("label",{class:"form-label"},"Benutzername",-1)),e("div",U,[s[8]||(s[8]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-person-fill"})],-1)),v(e("input",{"onUpdate:modelValue":s[2]||(s[2]=i=>l.value.username=i),type:"text",class:"form-control",placeholder:"Benutzername",required:""},null,512),[[b,l.value.username]])])]),e("div",q,[s[11]||(s[11]=e("label",{class:"form-label"},"E‑Mail",-1)),e("div",D,[s[10]||(s[10]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-envelope-fill"})],-1)),v(e("input",{"onUpdate:modelValue":s[3]||(s[3]=i=>l.value.email=i),type:"email",class:"form-control",placeholder:"vorname.nachname@fau.de",required:""},null,512),[[b,l.value.email]])])]),e("div",I,[s[13]||(s[13]=e("label",{class:"form-label"},"Vorname",-1)),e("div",T,[s[12]||(s[12]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-person-lines-fill"})],-1)),v(e("input",{"onUpdate:modelValue":s[4]||(s[4]=i=>l.value.firstName=i),type:"text",class:"form-control",placeholder:"Vorname"},null,512),[[b,l.value.firstName]])])]),e("div",F,[s[15]||(s[15]=e("label",{class:"form-label"},"Nachname",-1)),e("div",G,[s[14]||(s[14]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-person-badge-fill"})],-1)),v(e("input",{"onUpdate:modelValue":s[5]||(s[5]=i=>l.value.lastName=i),type:"text",class:"form-control",placeholder:"Nachname"},null,512),[[b,l.value.lastName]])])])])]),e("div",H,[e("button",{type:"button",class:"btn btn-outline-gradient d-flex align-items-center gap-1",onClick:s[6]||(s[6]=i=>o.$emit("close")),disabled:r.value},s[16]||(s[16]=[e("i",{class:"bi bi-x-lg"},null,-1),a(" Abbrechen ")]),8,O),e("button",{type:"submit",class:"btn btn-gradient d-flex align-items-center gap-1",disabled:r.value},[r.value?(d(),u("span",J)):f("",!0),s[17]||(s[17]=e("i",{class:"bi bi-check-lg"},null,-1)),a(" "+n(r.value?"Speichern…":"Speichern"),1)],8,R)])],32)])])])],64))}},L=h(K,[["__scopeId","data-v-e6d1a5b8"]]),Q={class:"profile-wrapper container py-4"},W={class:"profile-header card shadow-sm border-0 rounded-4 mb-4 overflow-hidden"},X={class:"bg-gradient-header p-4 d-flex flex-column flex-md-row align-items-center gap-4"},Y={class:"flex-grow-1 text-center text-md-start"},Z={class:"mb-1 text-gradient fw-bold d-flex align-items-center gap-2 justify-content-center justify-content-md-start"},ee={key:0,class:"badge badge-admin"},se={class:"meta-info text-secondary d-flex flex-column flex-sm-row gap-3 justify-content-center justify-content-md-start"},te={class:"action-buttons d-flex gap-2"},le={key:0,class:"text-center my-5"},oe={key:1,class:"profile-details card shadow-sm rounded-4 border-0"},ie={class:"card-body p-4"},ne={class:"row gx-4 gy-3"},ae={class:"col-12 col-md-6"},de={class:"section-card p-3"},re={class:"row mb-0"},ue={class:"col-7"},ce={class:"col-7"},me={class:"col-12 col-md-6"},pe={class:"section-card p-3"},ve={class:"row mb-0"},be={class:"col-7"},fe={class:"col-7"},ge={class:"col-7"},xe={class:"badge bg-primary-soft text-primary text-capitalize px-3 py-1"},ye={key:2,class:"alert alert-danger text-center py-4"},we={__name:"ProfileView",setup(y){const g=k(),t=p(null),c=p(!1),m=p(!1),l=p(!1);async function r(){c.value=!0;try{const o=await $.get("/profile");t.value=o.data}catch{g.show("Profil konnte nicht geladen werden","danger"),t.value=null}finally{c.value=!1}}function x(o){t.value=o,m.value=!1}return V(r),(o,s)=>(d(),u("div",Q,[e("div",W,[e("div",X,[s[8]||(s[8]=e("div",{class:"profile-avatar flex-shrink-0"},[e("div",{class:"avatar-circle shadow-lg"},[e("i",{class:"bi bi-person-circle"})])],-1)),e("div",Y,[e("h2",Z,[a(n(t.value?.firstName||"")+" "+n(t.value?.lastName||"")+" ",1),t.value?.isAdmin?(d(),u("span",ee,"Admin")):f("",!0)]),e("div",se,[e("span",null,[s[4]||(s[4]=e("i",{class:"bi bi-person me-1"},null,-1)),e("strong",null,n(t.value?.username),1)]),e("span",null,[s[5]||(s[5]=e("i",{class:"bi bi-envelope me-1"},null,-1)),a(" "+n(t.value?.email),1)])])]),e("div",te,[e("button",{class:"btn btn-gradient",onClick:s[0]||(s[0]=i=>m.value=!0)},s[6]||(s[6]=[e("i",{class:"bi bi-pencil"},null,-1),a("   Bearbeiten ")])),e("button",{class:"btn btn-outline-gradient",onClick:s[1]||(s[1]=i=>l.value=!0)},s[7]||(s[7]=[e("i",{class:"bi bi-key"},null,-1),a("   Passwort ändern ")]))])])]),c.value?(d(),u("div",le,s[9]||(s[9]=[e("div",{class:"spinner-border text-primary",role:"status"},null,-1)]))):t.value?(d(),u("div",oe,[e("div",ie,[e("div",ne,[e("div",ae,[e("div",de,[s[12]||(s[12]=e("h5",{class:"section-title mb-3"},[e("i",{class:"bi bi-person-lines-fill me-2"}),a("Persönlich")],-1)),e("dl",re,[s[10]||(s[10]=e("dt",{class:"col-5"},"Vorname",-1)),e("dd",ue,n(t.value.firstName||"–"),1),s[11]||(s[11]=e("dt",{class:"col-5"},"Nachname",-1)),e("dd",ce,n(t.value.lastName||"–"),1)])])]),e("div",me,[e("div",pe,[s[16]||(s[16]=e("h5",{class:"section-title mb-3"},[e("i",{class:"bi bi-info-circle me-2"}),a("Nutzerinformationen")],-1)),e("dl",ve,[s[13]||(s[13]=e("dt",{class:"col-5"},"Benutzername",-1)),e("dd",be,n(t.value.username),1),s[14]||(s[14]=e("dt",{class:"col-5"},"E‑Mail",-1)),e("dd",fe,n(t.value.email),1),s[15]||(s[15]=e("dt",{class:"col-5"},"Rolle",-1)),e("dd",ge,[e("span",xe,n(t.value.isAdmin?"Admin":"Nutzer"),1)])])])])])])])):(d(),u("div",ye,s[17]||(s[17]=[e("i",{class:"bi bi-exclamation-triangle me-2"},null,-1),a(" Profil konnte nicht geladen werden. ")]))),l.value?(d(),_(C,{key:3,onClose:s[2]||(s[2]=i=>l.value=!1)})):f("",!0),m.value?(d(),_(L,{key:4,"initial-profile":t.value,onClose:s[3]||(s[3]=i=>m.value=!1),onSaved:x},null,8,["initial-profile"])):f("",!0)]))}},ke=h(we,[["__scopeId","data-v-04e072b3"]]);export{ke as default};
