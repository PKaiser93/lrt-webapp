import{h as F,d as H,j as d,x as u,k as t,q as J,v as y,l as N,J as Z,m as S,t as f,o as q,z as K,r as p,w as h,E as B,G as _,K as M,F as z,y as V,C as ee,D as te,c as U,H as se,u as P,I as le}from"./auth-p59NCVpB.js";import{_ as E,d as ie}from"./index-BaOz1LJw.js";import{u as re}from"./betriebssystemStore-DJDJTNgq.js";function ne(s={}){return F.get("/computer",{params:s})}function oe(s){return F.get(`/computer/${s}`)}function ae(s){return F.post("/computer",s)}function ue(s,i){return F.patch(`/computer/${s}`,i)}function de(s){return F.patch(`/computer/${s}/soft-delete`)}function ce(s){return F.patch(`/computer/${s}/restore`)}const me=H("computer",{state:()=>({selected:null,isLoading:!1,items:[],total:0,error:null}),actions:{async fetchAll(s={}){this.isLoading=!0;try{const r=(await ne(s)).data;Array.isArray(r)?(this.items=r,this.total=r.length):(this.items=r.items||[],this.total=r.total||r.items?.length||0),this.error=null}catch(i){this.error=i.response?.data?.error||"Unbekannter Fehler"}finally{this.isLoading=!1}},async fetchById(s){this.isLoading=!0;try{const{data:i}=await oe(s);this.selected=i,this.error=null}catch(i){this.selected=null,this.error=i.response?.data?.error||"Unbekannter Fehler"}finally{this.isLoading=!1}},async create(s){this.isLoading=!0;try{const i=await ae(s);return this.computers.push(i.data),this.error=null,i.data}catch(i){throw this.error=i.response?.data?.error||"Unbekannter Fehler",i}finally{this.isLoading=!1}},async update(s,i){this.isLoading=!0;try{const r=await ue(s,i),v=this.computers.findIndex(m=>m._id===s);return v!==-1&&(this.computers[v]=r.data),this.error=null,r.data}catch(r){throw this.error=r.response?.data?.error||"Unbekannter Fehler",r}finally{this.isLoading=!1}},async delete(s){this.isLoading=!0;try{await de(s),this.computers=this.computers.filter(i=>i._id!==s),this.error=null}catch(i){throw this.error=i.response?.data?.error||"Unbekannter Fehler",i}finally{this.isLoading=!1}},async restore(s){this.isLoading=!0;try{await ce(s),await this.fetchAll(),this.error=null}catch(i){throw this.error=i.response?.data?.error||"Unbekannter Fehler",i}finally{this.isLoading=!1}},clearSelected(){this.selected=null}}}),pe={key:0},ve={key:0,class:"bi bi-caret-up-fill"},be={key:1,class:"bi bi-caret-down-fill"},ge={key:1,style:{opacity:".4"}},L={__name:"SortArrow",props:["field","sortField","sortDir"],setup(s){return(i,r)=>s.field===s.sortField?(u(),d("span",pe,[s.sortDir==="asc"?(u(),d("i",ve)):(u(),d("i",be))])):(u(),d("span",ge,r[0]||(r[0]=[t("i",{class:"bi bi-arrow-down-up"},null,-1)])))}},fe={class:"text-center align-middle"},ye={class:"text-center align-middle"},ke={class:"text-center align-middle"},xe={class:"text-center align-middle"},Se={class:"text-center align-middle"},he={class:"text-center align-middle"},$e={class:"text-center align-middle"},Ce={class:"text-center align-middle"},we={class:"d-inline-flex gap-sm"},Le=["disabled"],Fe={key:0,class:"spinner-border spinner-border-sm"},De={key:1,class:"bi bi-trash"},Ae={__name:"TableRow",props:{comp:{type:Object,required:!0},deletingId:[String,Number]},emits:["delete"],setup(s,{emit:i}){const r=i;function v(m){return m&&m.farbe?m.farbe:"var(--clr-border)"}return(m,a)=>{const k=J("router-link");return u(),d("tr",{class:K({"table-danger":s.deletingId===s.comp._id})},[t("td",fe,y(s.comp.dnsName),1),t("td",ye,y(s.comp.ipAdresse),1),t("td",ke,y(s.comp.marke),1),t("td",xe,y(s.comp.cpu),1),t("td",Se,y(s.comp.ram)+" GB",1),t("td",he,y(s.comp.raumnummer),1),t("td",$e,[s.comp.kategorie?(u(),d("span",{key:0,class:"badge",style:Z({backgroundColor:v(s.comp.kategorie),color:"#fff"})},y(s.comp.kategorie.bezeichnung||s.comp.kategorie),5)):N("",!0)]),t("td",Ce,[t("div",we,[S(k,{to:`/computer/${s.comp._id}`,class:"btn btn-outline btn-sm",title:"Details"},{default:q(()=>a[1]||(a[1]=[t("i",{class:"bi bi-eye"},null,-1)])),_:1,__:[1]},8,["to"]),a[3]||(a[3]=f("   ")),S(k,{to:`/computer/${s.comp._id}/edit`,class:"btn btn-outline btn-sm",title:"Bearbeiten"},{default:q(()=>a[2]||(a[2]=[t("i",{class:"bi bi-pencil"},null,-1)])),_:1,__:[2]},8,["to"]),a[4]||(a[4]=f("   ")),t("button",{class:"btn btn-outline btn-sm",disabled:s.deletingId===s.comp._id,onClick:a[0]||(a[0]=x=>r("delete",s.comp._id)),title:"Löschen"},[s.deletingId===s.comp._id?(u(),d("span",Fe)):(u(),d("i",De))],8,Le)])])],2)}}},Ue=E(Ae,[["__scopeId","data-v-55d7d4ce"]]),Ie={class:"input-group flex-grow-1"},Ke={class:"input-group select-kategorie"},Re=["value"],Be={class:"input-group select-os"},Oe=["value"],Ne={class:"input-group select-status"},ze={__name:"FilterSidebar",props:{kategorieList:{type:Array,default:()=>[]},osList:{type:Array,default:()=>[]},search:String,useRegex:Boolean,selectedKategorie:String,selectedOS:String,selectedStatus:{type:String,default:""}},emits:["update:search","update:useRegex","update:selectedKategorie","update:selectedOS","update:selectedStatus","apply"],setup(s,{emit:i}){const r=s,v=i,m=p(r.search||""),a=p(r.useRegex||!1),k=p(r.selectedKategorie||""),x=p(r.selectedOS||""),$=p(r.selectedStatus||"");h(()=>r.search,n=>m.value=n),h(()=>r.useRegex,n=>a.value=n),h(()=>r.selectedKategorie,n=>k.value=n),h(()=>r.selectedOS,n=>x.value=n),h(()=>r.selectedStatus,n=>$.value=n),h(m,n=>v("update:search",n)),h(a,n=>v("update:useRegex",n)),h(k,n=>v("update:selectedKategorie",n)),h(x,n=>v("update:selectedOS",n)),h($,n=>v("update:selectedStatus",n));function C(){v("apply")}function b(){m.value="",a.value=!1,k.value="",x.value="",$.value="",C()}return(n,l)=>(u(),d("form",{class:"filter-toolbar d-flex align-items-center flex-nowrap gap-2",onSubmit:te(C,["prevent"]),autocomplete:"off"},[t("div",Ie,[l[5]||(l[5]=t("span",{class:"input-group-text"},[t("i",{class:"bi bi-search"})],-1)),B(t("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>m.value=c),class:"form-control form-control-sm",placeholder:"Suche…"},null,512),[[_,m.value]])]),t("button",{type:"button",class:K(["btn","btn-sm","btn-icon",{active:a.value}]),onClick:l[1]||(l[1]=c=>a.value=!a.value),title:"Regex‑Suche"},l[6]||(l[6]=[t("i",{class:"bi bi-code-slash"},null,-1)]),2),t("div",Ke,[l[8]||(l[8]=t("span",{class:"input-group-text"},[t("i",{class:"bi bi-folder2"})],-1)),B(t("select",{"onUpdate:modelValue":l[2]||(l[2]=c=>k.value=c),class:"form-select form-select-sm"},[l[7]||(l[7]=t("option",{value:""},"Kategorie (alle)",-1)),(u(!0),d(z,null,V(s.kategorieList,c=>(u(),d("option",{key:c._id,value:c.bezeichnung},y(c.bezeichnung),9,Re))),128))],512),[[M,k.value]])]),t("div",Be,[l[10]||(l[10]=t("span",{class:"input-group-text"},[t("i",{class:"bi bi-hdd-network"})],-1)),B(t("select",{"onUpdate:modelValue":l[3]||(l[3]=c=>x.value=c),class:"form-select form-select-sm"},[l[9]||(l[9]=t("option",{value:""},"OS (alle)",-1)),(u(!0),d(z,null,V(s.osList,c=>(u(),d("option",{key:c._id||c.name,value:c.name||c},y(c.name||c),9,Oe))),128))],512),[[M,x.value]])]),t("div",Ne,[l[12]||(l[12]=t("span",{class:"input-group-text"},[t("i",{class:"bi bi-info-circle"})],-1)),B(t("select",{"onUpdate:modelValue":l[4]||(l[4]=c=>$.value=c),class:"form-select form-select-sm"},l[11]||(l[11]=[ee('<option value="" data-v-3a5de651>Status (alle)</option><option value="in_betrieb" data-v-3a5de651>In Betrieb</option><option value="bald_ersetzen" data-v-3a5de651>Bald ersetzen</option><option value="ausser_betrieb" data-v-3a5de651>Außer Betrieb</option><option value="ausser_betrieb" data-v-3a5de651>Auf Lager</option><option value="unbekannt" data-v-3a5de651>Unbekannt</option>',6)]),512),[[M,$.value]])]),l[14]||(l[14]=t("button",{type:"submit",class:"btn btn-primary btn-sm d-flex align-items-center gap-1"},[t("i",{class:"bi bi-funnel"}),f(" Filtern ")],-1)),t("button",{type:"button",class:"btn btn-outline btn-sm",onClick:b},l[13]||(l[13]=[t("i",{class:"bi bi-x-circle"},null,-1)]))],32))}},Ve=E(ze,[["__scopeId","data-v-3a5de651"]]);function Te(s){return F.get("/kategorie",{params:s})}const je=H("kategorie",()=>{const s=p([]),i=p(!1),r=p(null);async function v(m={}){i.value=!0,r.value=null;try{const a=await Te(m);s.value=a.data}catch(a){r.value=a.message||"Fehler beim Laden"}finally{i.value=!1}}return{items:s,isLoading:i,error:r,fetchAll:v}}),Me={class:"container py-lg"},Pe={class:"d-flex justify-content-between align-items-center flex-wrap mb-4"},qe={class:"d-flex justify-content-between align-items-center mb-4"},Ee={key:0,class:"fs-sm"},Ge={key:0,class:"text-center py-xl"},He={key:1},Je={key:0,class:"alert alert-danger mb-4"},We={class:"card"},Qe={class:"table-responsive"},Xe={class:"table mb-0"},Ye={key:1},Ze={key:1,class:"mt-4"},_e={class:"pagination justify-content-center"},et=["onClick"],O=25,tt={__name:"ComputerList",setup(s){const i=me(),r=re(),v=je(),m=ie(),a=p(""),k=p(!1),x=p(""),$=p(""),C=p("in_betrieb"),b=p(1),n=p("dnsName"),l=p("asc"),c=U(()=>i.total),D=U(()=>Math.ceil(c.value/O));function w(g){n.value===g?l.value=l.value==="asc"?"desc":"asc":(n.value=g,l.value="asc")}async function R(){const g=[];a.value&&g.push(a.value),x.value&&g.push(`KATEGORIE:${x.value}`),$.value&&g.push(`OS:${$.value}`),C.value&&g.push(`STATUS:${C.value}`),await i.fetchAll({query:g.join(" "),regex:k.value,page:b.value,perPage:O})}h([a,k,x,$,C],()=>{b.value=1,R()},{immediate:!0}),h(b,R);const W=U(()=>{const g=[...i.items||[]],e=l.value==="asc"?1:-1;return g.sort((j,o)=>{let A=j[n.value],I=o[n.value];return typeof A=="string"&&(A=A.toLowerCase()),typeof I=="string"&&(I=I.toLowerCase()),A<I?-1*e:A>I?1*e:0}),g}),G=U(()=>W.value.slice((b.value-1)*O,b.value*O)),T=p(null);async function Q(g){if(confirm("Willst du diesen Computer wirklich löschen?")){T.value=g;try{await i.delete(g),m.show("Computer gelöscht","success"),R()}catch{m.show(i.error||"Löschen fehlgeschlagen","danger")}finally{T.value=null}}}const X=U(()=>v.items||[]),Y=U(()=>r.items||[]);return se(()=>{v.fetchAll(),r.fetchAll()}),(g,e)=>{const j=J("router-link");return u(),d("div",Me,[t("div",Pe,[e[16]||(e[16]=t("h2",{class:"fs-xl fw-bold gradient-text d-flex align-items-center gap-sm mb-0"},[t("i",{class:"bi bi-pc-display"}),f(" Computerliste ")],-1)),S(j,{to:"/computer/neu",class:"btn btn-primary d-flex align-items-center gap-sm",title:"Neuen Computer anlegen"},{default:q(()=>e[15]||(e[15]=[t("i",{class:"bi bi-plus-circle"},null,-1),f(" Neuen Computer anlegen ")])),_:1,__:[15]})]),S(Ve,{kategorieList:X.value,osList:Y.value,search:a.value,"onUpdate:search":e[0]||(e[0]=o=>a.value=o),useRegex:k.value,"onUpdate:useRegex":e[1]||(e[1]=o=>k.value=o),selectedKategorie:x.value,"onUpdate:selectedKategorie":e[2]||(e[2]=o=>x.value=o),selectedOS:$.value,"onUpdate:selectedOS":e[3]||(e[3]=o=>$.value=o),selectedStatus:C.value,"onUpdate:selectedStatus":e[4]||(e[4]=o=>C.value=o),onApply:R,class:"mb-4"},null,8,["kategorieList","osList","search","useRegex","selectedKategorie","selectedOS","selectedStatus"]),t("div",qe,[t("div",null,[e[17]||(e[17]=f("Gefundene Computer: ")),t("strong",null,y(c.value),1)]),D.value>1?(u(),d("div",Ee,"Seite "+y(b.value)+" von "+y(D.value),1)):N("",!0)]),P(i).isLoading?(u(),d("div",Ge,e[18]||(e[18]=[t("span",{class:"spinner-border"},null,-1)]))):(u(),d("div",He,[P(i).error?(u(),d("div",Je,y(P(i).error),1)):N("",!0),t("div",We,[t("div",Qe,[t("table",Xe,[t("thead",null,[t("tr",null,[t("th",{onClick:e[5]||(e[5]=o=>w("dnsName")),class:"cursor-pointer"},[e[19]||(e[19]=t("i",{class:"bi bi-hash me-sm"},null,-1)),e[20]||(e[20]=f("DNS ")),S(L,{field:"dnsName",sortField:n.value,sortDir:l.value},null,8,["sortField","sortDir"])]),t("th",{onClick:e[6]||(e[6]=o=>w("ipAdresse")),class:"cursor-pointer"},[e[21]||(e[21]=t("i",{class:"bi bi-diagram-2 me-sm"},null,-1)),e[22]||(e[22]=f("IP ")),S(L,{field:"ipAdresse",sortField:n.value,sortDir:l.value},null,8,["sortField","sortDir"])]),t("th",{onClick:e[7]||(e[7]=o=>w("marke")),class:"cursor-pointer"},[e[23]||(e[23]=t("i",{class:"bi bi-building me-sm"},null,-1)),e[24]||(e[24]=f("Marke ")),S(L,{field:"marke",sortField:n.value,sortDir:l.value},null,8,["sortField","sortDir"])]),t("th",{onClick:e[8]||(e[8]=o=>w("cpu")),class:"cursor-pointer"},[e[25]||(e[25]=t("i",{class:"bi bi-cpu me-sm"},null,-1)),e[26]||(e[26]=f("CPU ")),S(L,{field:"cpu",sortField:n.value,sortDir:l.value},null,8,["sortField","sortDir"])]),t("th",{onClick:e[9]||(e[9]=o=>w("ram")),class:"cursor-pointer"},[e[27]||(e[27]=t("i",{class:"bi bi-memory me-sm"},null,-1)),e[28]||(e[28]=f("RAM ")),S(L,{field:"ram",sortField:n.value,sortDir:l.value},null,8,["sortField","sortDir"])]),t("th",{onClick:e[10]||(e[10]=o=>w("raumnummer")),class:"cursor-pointer"},[e[29]||(e[29]=t("i",{class:"bi bi-door-open me-sm"},null,-1)),e[30]||(e[30]=f("Raum ")),S(L,{field:"raumnummer",sortField:n.value,sortDir:l.value},null,8,["sortField","sortDir"])]),t("th",{onClick:e[11]||(e[11]=o=>w("kategorie.bezeichnung")),class:"cursor-pointer"},[e[31]||(e[31]=t("i",{class:"bi bi-tags me-sm"},null,-1)),e[32]||(e[32]=f("Kategorie ")),S(L,{field:"kategorie.bezeichnung",sortField:n.value,sortDir:l.value},null,8,["sortField","sortDir"])]),t("th",{onClick:e[12]||(e[12]=o=>w("status")),class:"cursor-pointer"},[e[33]||(e[33]=t("i",{class:"bi bi-info-circle me-sm"},null,-1)),e[34]||(e[34]=f("Status ")),S(L,{field:"status",sortField:n.value,sortDir:l.value},null,8,["sortField","sortDir"])]),e[35]||(e[35]=t("th",null,"Aktionen",-1))])]),t("tbody",null,[G.value.length?(u(!0),d(z,{key:0},V(G.value,o=>(u(),le(Ue,{key:o._id,comp:o,deletingId:T.value,onDelete:Q},null,8,["comp","deletingId"]))),128)):(u(),d("tr",Ye,e[36]||(e[36]=[t("td",{colspan:"9",class:"text-center text-secondary py-xl"},[t("i",{class:"bi bi-emoji-frown me-sm"}),f("Keine Computer gefunden. ")],-1)])))])])])]),D.value>1?(u(),d("nav",Ze,[t("ul",_e,[t("li",{class:K(["page-item",{disabled:b.value===1}])},[t("button",{class:"page-link",onClick:e[13]||(e[13]=o=>b.value>1&&b.value--)},"«")],2),(u(!0),d(z,null,V(D.value,o=>(u(),d("li",{class:K(["page-item",{active:b.value===o}]),key:o},[t("button",{class:"page-link",onClick:A=>b.value=o},y(o),9,et)],2))),128)),t("li",{class:K(["page-item",{disabled:b.value===D.value}])},[t("button",{class:"page-link",onClick:e[14]||(e[14]=o=>b.value<D.value&&b.value++)},"»")],2)])])):N("",!0)]))])}}},rt=E(tt,[["__scopeId","data-v-775bcf6f"]]);export{rt as default};
